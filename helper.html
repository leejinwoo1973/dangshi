
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‹¹ì‹œ(å”è©©) ë°ì´í„° ë³€í™˜ ë„ìš°ë¯¸</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; }
        body { font-family: 'Noto Serif KR', serif; background-color: #f0f2f5; padding: 20px; color: #333; margin: 0; }
        h1 { text-align: center; color: #8B0000; margin-bottom: 20px; text-shadow: 1px 1px 2px rgba(0,0,0,0.1); }
        
        .container { display: flex; gap: 20px; max-width: 1400px; margin: 0 auto; height: 85vh; }
        .input-panel { flex: 1; display: flex; flex-direction: column; gap: 10px; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .output-panel { flex: 1; display: flex; flex-direction: column; gap: 10px; background: #fff8e1; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border: 2px solid #8B0000; }
        
        label { font-weight: bold; font-size: 0.9rem; color: #555; display: flex; justify-content: space-between; align-items: center; }
        input[type="text"] { padding: 10px; border: 1px solid #ccc; border-radius: 5px; width: 100%; font-size: 1rem; }
        textarea { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; font-size: 0.95rem; resize: none; font-family: 'Noto Serif KR', serif; line-height: 1.6; }
        
        .btn { padding: 12px; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; font-size: 1rem; transition: background 0.2s; }
        .btn-convert { background: #8B0000; color: white; margin-top: auto; }
        .btn-convert:hover { background: #a00000; }
        .btn-copy { background: #28a745; color: white; height: 50px; font-size: 1.2rem; }
        .btn-copy:hover { background: #218838; }
        .btn-clear { background: #666; color: white; font-size: 0.8rem; padding: 5px 10px; }

        .guide-box { background: #e3f2fd; padding: 10px; border-radius: 5px; font-size: 0.85rem; color: #0d47a1; margin-bottom: 10px; }
        
        /* ì£¼ì„ ê°ì§€ í•˜ì´ë¼ì´íŠ¸ */
        .highlight { color: red; font-weight: bold; }
    </style>
</head>
<body>

    <h1>ğŸ“œ ë‹¹ì‹œ(å”è©©) ë°ì´í„° ë³€í™˜ ë„ìš°ë¯¸</h1>

    <div class="container">
        <div class="input-panel">
            <div style="display:flex; justify-content:space-between;">
                <h3>1. ë°ì´í„° ì…ë ¥</h3>
                <button class="btn btn-clear" onclick="clearInputs()">ìƒˆë¡œ ì‘ì„± (ì´ˆê¸°í™”)</button>
            </div>
            
            <div class="guide-box">
                <b>ğŸ’¡ íŒ:</b> ë™ì–‘ê³ ì „ì¢…í•©DBì—ì„œ ê° êµ¬ì—­ì„ ë³µì‚¬í•´ì„œ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.<br>
                ì£¼ì„ì€ "1. ì„¤ëª…" ë˜ëŠ” "[1] ì„¤ëª…" í˜•ì‹ì˜ ëª©ë¡ì„ ì¸ì‹í•©ë‹ˆë‹¤.
            </div>

            <div>
                <label>ì œëª© (í•œì)</label>
                <input type="text" id="inTitle" placeholder="ì˜ˆ: æ˜¥æœ›">
            </div>

            <div style="flex:1; display:flex; flex-direction:column;">
                <label>ì›ë¬¸ (í•œìë§Œ)</label>
                <textarea id="inHanja" style="flex:1;" placeholder="åœ‹ç ´å±±æ²³åœ¨..."></textarea>
            </div>

            <div style="flex:2; display:flex; flex-direction:column;">
                <label>ë²ˆì—­ë¬¸ + ì£¼ì„ ëª©ë¡ (í†µì§¸ë¡œ ë¶™ì—¬ë„£ê¸°)</label>
                <textarea id="inDesc" style="flex:1;" placeholder="ë‚˜ë¼ëŠ” ë§í–ˆìœ¼ë‚˜ ì‚°í•˜ëŠ” ê·¸ëŒ€ë¡œì—¬ì„œ...&#13;&#10;1. åœ‹ç ´(êµ­íŒŒ): ë„ì„±ì¸ ì¥ì•ˆì´ í•¨ë½ë¨.&#13;&#10;2. åŸ(ì„±): ì¥ì•ˆì„±."></textarea>
            </div>

            <button class="btn btn-convert" onclick="convertData()">âš¡ ë³€í™˜í•˜ê¸° (ì£¼ì„ ìë™ í•©ì²´)</button>
        </div>

        <div class="output-panel">
            <h3>2. ë³€í™˜ ê²°ê³¼</h3>
            <div class="guide-box" style="background:#e8f5e9; color:#1b5e20;">
                ì´ ë‚´ìš©ì„ ë³µì‚¬í•´ì„œ ê´€ë¦¬ì í˜ì´ì§€ <b>[ìƒì„¸ ë‚´ìš©]</b>ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.<br>
                ê·¸ í›„ <b>+++ (ê°„ì²´)</b>, <b>{{ì˜¤ë””ì˜¤}}</b> ë“±ì„ ì¶”ê°€í•˜ë©´ ë©ë‹ˆë‹¤.
            </div>
            <textarea id="outResult" style="flex:1; background:#fff;"></textarea>
            <button class="btn btn-copy" onclick="copyResult()">ğŸ“‹ ê²°ê³¼ ë³µì‚¬í•˜ê¸°</button>
        </div>
    </div>

    <script>
        function convertData() {
            const title = document.getElementById('inTitle').value.trim();
            const hanja = document.getElementById('inHanja').value.trim();
            let descRaw = document.getElementById('inDesc').value;

            if (!title) { alert('ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”.'); return; }

            // 1. ì£¼ì„ ëª©ë¡ ì¶”ì¶œ ë° ë¶„ë¦¬
            // íŒ¨í„´: ì¤„ ì‹œì‘ì´ ìˆ«ì+ì (1.) ë˜ëŠ” ê´„í˜¸ìˆ«ì((1)) ë˜ëŠ” ëŒ€ê´„í˜¸ìˆ«ì([1])
            const footnoteRegex = /^(\d+|\[\d+\]|\(\d+\))[\.\s]+(.*)$/gm;
            let footnotes = {};
            let descBody = [];
            
            // ë³¸ë¬¸ê³¼ ì£¼ì„ ëª©ë¡ì„ ì¤„ ë‹¨ìœ„ë¡œ ë¶„ë¦¬
            const lines = descRaw.split('\n');
            let isFootnoteSection = false;

            lines.forEach(line => {
                const cleanLine = line.trim();
                if (!cleanLine) return;

                // ì£¼ì„ ë¼ì¸ì¸ì§€ í™•ì¸
                // (ë³´í†µ ì£¼ì„ ëª©ë¡ì€ ë³¸ë¬¸ ì•„ë˜ì— ëª°ë ¤ ìˆìœ¼ë¯€ë¡œ, í•œ ë²ˆ ì£¼ì„ì´ ë‚˜ì˜¤ê¸° ì‹œì‘í•˜ë©´ ê·¸ ë’¤ëŠ” ë‹¤ ì£¼ì„ìœ¼ë¡œ ê°„ì£¼)
                const match = /^(\d+|\[\d+\]|\(\d+\))[\.\)]\s*(.*)/.exec(cleanLine);
                
                if (match) {
                    isFootnoteSection = true; // ì£¼ì„ êµ¬ê°„ ì§„ì…
                    let num = match[1].replace(/[\[\]\(\)]/g, ''); // ìˆ«ìë§Œ ì¶”ì¶œ
                    footnotes[num] = match[2]; // ë‚´ìš© ì €ì¥
                } else {
                    if (!isFootnoteSection) {
                        descBody.push(cleanLine); // ì•„ì§ ì£¼ì„ êµ¬ê°„ ì•„ë‹ˆë©´ ë³¸ë¬¸
                    } else {
                        // ì£¼ì„ êµ¬ê°„ì— ë“¤ì–´ì™”ëŠ”ë° ìˆ«ìë¡œ ì‹œì‘ ì•ˆ í•˜ë©´? ì• ì£¼ì„ì˜ ì—°ì¥ì„ ì¼ ìˆ˜ ìˆìŒ
                        // ì—¬ê¸°ì„  ë‹¨ìˆœí•˜ê²Œ ë³¸ë¬¸ìœ¼ë¡œ ì²˜ë¦¬í•˜ê±°ë‚˜ ë¬´ì‹œ (ìƒí™©ì— ë”°ë¼ ë‹¤ë¦„)
                        // ì¼ë‹¨ì€ ì£¼ì„ì˜ ì—°ì¥ì„ ìœ¼ë¡œ ë³´ê³  ë§ˆì§€ë§‰ ì£¼ì„ì— ë¶™ì„
                        /* ë³µì¡ë„ ì¤„ì´ê¸° ìœ„í•´ íŒ¨ìŠ¤ */
                    }
                }
            });

            // 2. ë³¸ë¬¸ ë‚´ ë²ˆí˜¸ ì¹˜í™˜ ( 1 -> [* ë‚´ìš©] )
            let finalDesc = descBody.join('\n');
            
            // ë²ˆí˜¸ ë§¤ì¹­ (ì—­ìˆœìœ¼ë¡œ ì²˜ë¦¬í•´ì•¼ 11ì´ 1ë¡œ ì˜¤ì¸ë˜ëŠ” ê²ƒ ë°©ì§€. ê·¼ë° ì—¬ê¸°ì„  ê´„í˜¸ë‚˜ ê³µë°±ìœ¼ë¡œ êµ¬ë¶„)
            // ë³´í†µ ë³¸ë¬¸ì—ëŠ” "ë‹¨ì–´1)" ë˜ëŠ” "ë‹¨ì–´(1)" ë˜ëŠ” "ë‹¨ì–´[1]" í˜•íƒœë¡œ ì˜´.
            // ë™ì–‘ê³ ì „DB íŠ¹ì„±ìƒ ê·¸ëƒ¥ ì‘ì€ ìˆ«ìê°€ ë¶™ì–´ìˆê±°ë‚˜ ê´„í˜¸ê°€ ìˆìŒ.
            
            Object.keys(footnotes).sort((a, b) => b - a).forEach(num => {
                const noteContent = footnotes[num];
                const replacement = `[* ${noteContent}]`;
                
                // íŒ¨í„´ 1: ê´„í˜¸ ìˆëŠ” ìˆ«ì (1) -> [* ë‚´ìš©]
                finalDesc = finalDesc.split(`(${num})`).join(replacement);
                finalDesc = finalDesc.split(`[${num}]`).join(replacement);
                
                // íŒ¨í„´ 2: ê·¸ëƒ¥ ìˆ«ì (ë‹¨, ë’¤ì— í•œê¸€ì´ë‚˜ ë¬¸ìê°€ ë°”ë¡œ ë¶™ì§€ ì•ŠëŠ” ê²½ìš° ë“± ì œì•½ í•„ìš”)
                // ë„ˆë¬´ ìœ„í—˜í•˜ë¯€ë¡œ ê´„í˜¸ ì—†ëŠ” ìˆ«ìëŠ” ìˆ˜ë™ ê²€ìˆ˜ ê¶Œì¥í•˜ê±°ë‚˜,
                // ì‚¬ìš©ìê°€ ë³µì‚¬í•´ì˜¬ ë•Œ ê´„í˜¸ê°€ ìˆëŠ” ê²½ìš°ê°€ ë§ìŒ.
                
                // (ì„ íƒ) ë™ì–‘ê³ ì „DBëŠ” ì›ë¬¸ í•œìì— ì–´ê¹¨ë²ˆí˜¸ê°€ ë¶™ëŠ”ë°, í…ìŠ¤íŠ¸ ë³µì‚¬ì‹œ ìˆ«ìë¡œ ë‚˜ì˜´.
                // ì˜ˆ: åœ‹ç ´1) -> ì´ ê²½ìš° 1)ì„ ì°¾ìŒ
                finalDesc = finalDesc.split(`${num})`).join(replacement);
            });

            // 3. ìµœì¢… ì¡°ë¦½
            // í˜•ì‹: ì œëª© | í•œìì›ë¬¸ --- í•´ì„
            const result = `${title} | ${hanja}\n\n---\n${finalDesc}`;

            document.getElementById('outResult').value = result;
        }

        function copyResult() {
            const copyText = document.getElementById("outResult");
            copyText.select();
            document.execCommand("copy");
            alert("ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! ê´€ë¦¬ì í˜ì´ì§€ [ìƒì„¸ ë‚´ìš©]ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.");
        }

        function clearInputs() {
            if(confirm('ëª¨ë“  ë‚´ìš©ì„ ì§€ìš°ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                document.getElementById('inTitle').value = '';
                document.getElementById('inHanja').value = '';
                document.getElementById('inDesc').value = '';
                document.getElementById('outResult').value = '';
            }
        }
    </script>

</body>
</html>
